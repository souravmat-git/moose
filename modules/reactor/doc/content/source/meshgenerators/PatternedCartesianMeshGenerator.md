# PatternedCartesianMeshGenerator

!syntax description /Mesh/PatternedCartesianMeshGenerator

## Overview

The `PatternedCartesianMeshGenerator` object generates a 2D mesh by stitching cartesian (square-shaped) meshes generated by [`PolygonConcentricCircleMeshGenerator`](/PolygonConcentricCircleMeshGenerator.md), [`CartesianConcentricCircleAdaptiveBoundaryMeshGenerator`](/CartesianConcentricCircleAdaptiveBoundaryMeshGenerator.md), and itself, based on a user-defined square grid pattern. The generated 2D mesh can optionally contain an extra background region and/or external duct regions to form an expanded square external shape rather than a purely stacked square of squares.

## Geometry Information

In order to generate the square patterned mesh, three fundamental parameters are needed:

- [!param](/Mesh/PatternedCartesianMeshGenerator/inputs): a vector of mesh generator names that will be used as elements to form the patterned mesh;
- [!param](/Mesh/PatternedCartesianMeshGenerator/pattern): a two-dimensional vector that represents the pattern of mesh to be generated. The elements must be integers from 0 to N-1, where N is the length of vector parameter [!param](/Mesh/PatternedCartesianMeshGenerator/inputs).
- [!param](/Mesh/PatternedCartesianMeshGenerator/pattern_boundary): a MooseEnum parameter that can be either `none` or `expanded`. When `none` is selected, this object only stitches [!param](/Mesh/PatternedCartesianMeshGenerator/inputs) meshes into a patterned mesh without extraneous geometry, resulting in a simply stacked square of unit squares. When `expanded` is selected, a background region is added so that the generated mesh has an expanded square shape instead of a simply stacked one. Concentric duct regions may also be optionally added to the square periphery when this parameter is `expanded`. The user can refer to [Figure 1](#pattern_cart) for more details.

!media reactor/meshgenerators/pattern_cart.png
      style=display: block;margin-left:auto;margin-right:auto;width:40%;
      id=pattern_cart
      caption=A schematic showing the difference between `none` and `expanded` `pattern_boundary`.

When [!param](/Mesh/PatternedCartesianMeshGenerator/pattern_boundary) is set as `expanded`, the user can also provide [!param](/Mesh/PatternedCartesianMeshGenerator/duct_sizes) in either `apothem` (center-to-face) or `radius` (center-to-vertex) style determined by [!param](/Mesh/PatternedCartesianMeshGenerator/duct_sizes_style) to add external duct regions to the generated square mesh. Also, [!param](/Mesh/PatternedCartesianMeshGenerator/square_size) must also be provided to define the external square boundary size. In some cases, if [!param](/Mesh/PatternedCartesianMeshGenerator/square_size) is small enough, the square external boundary may cut off some of the stitched square meshes. As long as the concentric circular (`rings`) regions are not cut off, the rest of the mesh is deformed to accommodate the limited external boundaries. Users can also set [!param](/Mesh/PatternedCartesianMeshGenerator/deform_non_circular_region) as `false` to prevent the non-circular regions from being deformed.

## Control Drum Related MeshMetaData

One of the applications of this object is to generate meshes for reactor cores with control drums. In that case, by setting [!param](/Mesh/PatternedCartesianMeshGenerator/generate_core_metadata) as true, control drum meshes can also be used as part of [!param](/Mesh/PatternedCartesianMeshGenerator/inputs) to construct the core mesh. To facilitate the use of control drum rotation simulation objects, a series of `MeshMetaData` can be generated, including:

- `control_drum_positions`: a vector of control drum center positions. This `MeshMetaData` can also be outputted as an ASCII file by setting [!param](/Mesh/PatternedCartesianMeshGenerator/generate_control_drum_positions_file) as true and providing [!param](/Mesh/PatternedCartesianMeshGenerator/position_file);
- `control_drum_angles`: a vector of the azimuthal angles of the control drum center positions to the center of the core.
- `control_drums_azimuthal_meta`: a two-dimensional vector containing the sorted azimuthal angles of nodes to the corresponding control drum center for all the control drums.

In addition, [!param](/Mesh/PatternedCartesianMeshGenerator/assign_control_drum_id) can be set as true so that the control drum [!param](/Mesh/PatternedCartesianMeshGenerator/inputs) meshes can be indexed using an element extra integer called `control_drum_id`. As illustrated in [Figure 2](#cd_id), the `control_drum_id` is indexed based on the azimuthal angles of the control drums.

!media reactor/meshgenerators/azi_cd_cart.png
      style=display: block;margin-left:auto;margin-right:auto;width:40%;
      id=cd_id
      caption=A schematic drawing the indexing rule of `control_drum_id` in the `PatternedCartesianMeshGenerator` object.

These `MeshMetaData` as well as `control_drum_id` can be used by other MOOSE objects such as [`MultiControlDrumFunction`](/MultiControlDrumFunction.md) to simulate control drums rotation during power transients.


## Example Syntax

!listing modules/reactor/test/tests/meshgenerators/patterned_cartesian_mesh_generator/patterned_pattern.i block=Mesh/pattern

!syntax parameters /Mesh/PatternedCartesianMeshGenerator

!syntax inputs /Mesh/PatternedCartesianMeshGenerator

!syntax children /Mesh/PatternedCartesianMeshGenerator
