# SIMPLENonlinearAssembly

!syntax description /Executioner/SIMPLENonlinearAssembly

## Overview

For the overview of the SIMPLE algorithm, please visit [SIMPLE.md].

This executioner implements the same iteration but it uses MOOSE's native
residual and Jacobian computing routines to build system matrices and
right hand sides. Even though this introduces an overhead in terms of computational
speed, it allows the utilization of the same variables, kernels and boundary conditions
that are used in the monolithic solvers.

## Example Input Syntax

The setup of a problem with the segregated solver in MOOSE is slightly different compared to
conventional monolithic solvers. In this section, we highlight the main differences.
For setting up a 2D simulation with the SIMPLE algorithm, we add three systems in MOOSE:
one for each momentum component and another for the pressure. The different systems
can be created within the `Problem` block:

!listing modules/navier_stokes/test/tests/finite_volume/ins/channel-flow/segregated/2d/2d-segregated-velocity.i block=Problem

It is visible that we requested that MOOSE keeps previous solution iterates as well. This is necessary to
facilitate the relaxation processes mentioned in [SIMPLE.md].

!listing modules/navier_stokes/test/tests/finite_volume/ins/channel-flow/segregated/2d/2d-segregated-velocity.i block=Variables

The kernels are then created similarly to the monolithic system, with the exception that now the kernels acting on pressure are slightly different:

!listing modules/navier_stokes/test/tests/finite_volume/ins/channel-flow/segregated/2d/2d-segregated-velocity.i block=p_diffusion p_source

By default, the coupling fields corresponding to $A^{-1}H$ and $A^{-1}$ are called `HbyA`
and `Ainv`, respectively. These fields are generated by
[INSFVRhieChowInterpolatorSegregated.md] under the hood. This means that we need to
add the user object responsible for generating these fields:

!listing modules/navier_stokes/test/tests/finite_volume/ins/channel-flow/segregated/2d/2d-segregated-velocity.i block=UserObjects

Next, we add the `SIMPLENonlinearAssembly` executioner:

!listing modules/navier_stokes/test/tests/finite_volume/ins/channel-flow/segregated/2d/2d-segregated-velocity.i block=Executioner

We see that it has a parameter called [!param](/Executioner/SIMPLENonlinearAssembly/pressure_gradient_tag). This tag needs to be added to the
pressure gradient kernels to enable the separation of terms needed in $A^{-1}H$. This can be easily done as follows in the `FVKernels`:

!listing modules/navier_stokes/test/tests/finite_volume/ins/channel-flow/segregated/2d/2d-segregated-velocity.i block=u_pressure v_pressure


!syntax parameters /Executioner/SIMPLENonlinearAssembly

!syntax inputs /Executioner/SIMPLENonlinearAssembly

!syntax children /Executioner/SIMPLENonlinearAssembly
